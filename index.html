<script>
let currentPage = 0;
const pages = document.querySelectorAll('.page');
const totalPages = pages.length;
const flipbook = document.getElementById('flipbook');

// Set initial z-index values for each page
pages.forEach((page, index) => {
    page.style.zIndex = totalPages - index;
});

function flipToPage(pageNumber) {
    if (pageNumber > currentPage) {
        for (let i = currentPage; i < pageNumber; i++) {
            pages[i].classList.add('flipped');
        }
    } else if (pageNumber < currentPage) {
        for (let i = currentPage - 1; i >= pageNumber; i--) {
            pages[i].classList.remove('flipped');
        }
    }
    currentPage = pageNumber;
}

document.getElementById('prev-btn').addEventListener('click', (e) => {
    e.preventDefault(); // Prevent default browser behavior
    if (currentPage > 0) {
        flipToPage(currentPage - 1);
    }
});

document.getElementById('next-btn').addEventListener('click', (e) => {
    e.preventDefault(); // Prevent default browser behavior
    if (currentPage < totalPages - 1) {
        flipToPage(currentPage + 1);
    }
});

// Zoom and Pan Functionality
const zoomSlider = document.getElementById('zoom-slider');
let zoomFactor = 1;
let offsetX = 0;
let offsetY = 0;

function updateZoomPan() {
    const transform = `scale(${zoomFactor}) translate(${offsetX}px, ${offsetY}px)`;
    flipbook.style.transform = transform;
}

// Event Listener for zoom control
zoomSlider.addEventListener('input', () => {
    zoomFactor = zoomSlider.value / 100;
    updateZoomPan();
});

// Add panning functionality for mouse events
let isPanning = false;
let startX = 0;
let startY = 0;

flipbook.addEventListener('mousedown', (e) => {
    // Check if the target is the zoom slider to prevent panning
    if (e.target.closest('input[type="range"]')) return;

    e.preventDefault(); // Prevent default browser behavior
    isPanning = true;
    startX = e.clientX - offsetX;
    startY = e.clientY - offsetY;
    flipbook.style.cursor = 'grabbing';
});

document.addEventListener('mousemove', (e) => {
    if (isPanning) {
        offsetX = e.clientX - startX;
        offsetY = e.clientY - startY;
        updateZoomPan();
    }
});

document.addEventListener('mouseup', () => {
    isPanning = false;
    flipbook.style.cursor = 'grab';
});

// Add panning functionality for touch events
let isTouchPanning = false;
let touchStartX = 0;
let touchStartY = 0;

flipbook.addEventListener('touchstart', (e) => {
    // Check if the target is the zoom slider to prevent panning
    if (e.target.closest('input[type="range"]')) return;

    isTouchPanning = true;
    const touch = e.touches[0];
    touchStartX = touch.clientX - offsetX;
    touchStartY = touch.clientY - offsetY;
});

flipbook.addEventListener('touchmove', (e) => {
    if (isTouchPanning) {
        const touch = e.touches[0];
        offsetX = touch.clientX - touchStartX;
        offsetY = touch.clientY - touchStartY;
        updateZoomPan();
    }
});

flipbook.addEventListener('touchend', () => {
    isTouchPanning = false;
});

// Initial update for zoom
updateZoomPan();
